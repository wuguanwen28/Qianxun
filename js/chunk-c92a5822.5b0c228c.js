(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c92a5822"],{"3da8":function(t,a,e){},"79db":function(t,a,e){"use strict";var s=e("3da8"),i=e.n(s);i.a},e73c:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"shopcart"},[t.allShopcartData.length>0?[e("van-nav-bar",{attrs:{fixed:!0,"right-text":t.isEdit?"完成":"管理"},on:{"click-right":t.manage}}),e("div",{staticClass:"list"},[e("van-list",{attrs:{"finished-text":"没有更多了","immediate-check":!1,finished:t.isFinished},on:{load:t.loadData},model:{value:t.isLoading,callback:function(a){t.isLoading=a},expression:"isLoading"}},t._l(t.shopcartData,(function(a,s){return e("van-swipe-cell",{key:s,attrs:{disabled:!t.isEdit},scopedSlots:t._u([{key:"right",fn:function(){return[e("van-button",{staticClass:"v-button",attrs:{square:"",color:"linear-gradient(to right, #CBA25F, #D39027)",text:"删除"},on:{click:function(e){return t.removeShopcart("one",a)}}})]},proxy:!0}],null,!0)},[e("van-cell",[e("div",{staticClass:"v-cell"},[e("div",{staticClass:"v-checkbox"},[e("van-checkbox",{attrs:{"checked-color":"#CB9D58",shape:"round"},on:{change:function(e){return t.simpleSelect(a)}},model:{value:a.isChecked,callback:function(e){t.$set(a,"isChecked",e)},expression:"item.isChecked"}})],1),e("div",{staticClass:"pro-img"},[e("img",{staticClass:"img-auto",attrs:{src:a.small_img}})]),e("div",{staticClass:"pro-info"},[e("div",{staticClass:"pro-name"},[t._v(t._s(a.name)),e("span",[t._v(t._s(a.enname))])]),e("div",{staticClass:"rule"},[t._v(t._s(a.rule))]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],staticClass:"clearfix ch-count"},[e("span",{staticClass:"fl"},[t._v("￥"+t._s(a.price))]),e("span",{staticClass:"fr"},[e("van-stepper",{on:{change:function(e){return t.changeCount(a)}},model:{value:a.count,callback:function(e){t.$set(a,"count",e)},expression:"item.count"}})],1)])])])])],1)})),1)],1),e("van-submit-bar",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit&&t.shopcartData.length>0,expression:"!isEdit && shopcartData.length > 0"}],attrs:{price:t.total,"button-text":"结 算","button-type":"info","safe-area-inset-bottom":!0},on:{submit:t.commit}},[e("van-checkbox",{attrs:{"checked-color":"#CB9D58"},on:{click:t.allSelect},model:{value:t.isAllChecked,callback:function(a){t.isAllChecked=a},expression:"isAllChecked"}},[t._v("全选")])],1),e("van-submit-bar",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&t.shopcartData.length>0,expression:"isEdit && shopcartData.length > 0"}],staticClass:"v-submit",attrs:{"button-text":"删 除","button-type":"info","safe-area-inset-bottom":!0},on:{submit:function(a){return t.removeShopcart("all")}}},[e("van-checkbox",{attrs:{"checked-color":"#CB9D58"},on:{click:t.allSelect},model:{value:t.isAllChecked,callback:function(a){t.isAllChecked=a},expression:"isAllChecked"}},[t._v("全选")])],1)]:[e("div",{staticClass:"not-shopcart-box"},[e("div",{staticClass:"not-shopcart"},[e("div",{staticClass:"not-shopcart-icon"},[e("van-icon",{attrs:{name:"shopping-cart"}})],1),e("div",[t._v(t._s(t.isLogin?"购物车竟然空空如也":"登录后才能查看购物车"))]),e("div",{staticClass:"last-item"},[t._v("再忙也要买一杯咖啡犒劳自己")])]),t.isLogin?e("div",[e("div",[e("van-divider",{style:{color:"#E5C474",borderColor:"#E5C474",padding:"0 16px"}},[e("van-icon",{attrs:{name:"like"}}),e("div",{staticStyle:{"margin-left":"5px"}},[t._v("为您推荐")])],1)],1),e("div",{staticClass:"like-box clearfix"},t._l(t.recommendData,(function(a,s){return e("div",{key:s,class:[s%2==0?"a":"b"],on:{click:function(e){return t.goPage(a.pid)}}},[e("div",[e("img",{staticClass:"img-auto",attrs:{src:a.smallImg,alt:""}})]),e("div",{staticClass:"title"},[t._v(t._s(a.name)+" "),e("span",{staticClass:"fr delete"},[t._v("￥"+t._s(a.price))])])])})),0)]):t._e()])]],2)},i=[],o=(e("4160"),e("a15b"),e("fb6a"),e("a434"),e("159b"),e("5530")),c=e("2f62"),n=e("fa7d"),r={name:"Shopcart",data:function(){return{isLoading:!1,isAllChecked:!1,total:0,isLogin:!0}},created:function(){var t=this,a=n["a"].isLogin("登录后才查看购物车，是否登录？",this);if(a){this.$store.commit("shopcartModule/emptyData");var e=n["a"].getToken(this);this.axios({method:"GET",url:"/findAllShopcart",params:{appkey:this.appkey,tokenString:e}}).then((function(a){if("5000"==a.data.code){var e=a.data.result;e.forEach((function(t){t.isChecked=!1})),t.$store.commit("shopcartModule/changeData",{key:"allShopcartData",value:e}),t.allShopcartData.length>=6&&(e=e.slice(0,6)),t.$store.commit("shopcartModule/changeData",{key:"shopcartData",value:e})}})),this.getRecommendData()}else this.isLogin=!1},computed:Object(o["a"])({},Object(c["b"])("shopcartModule",["isEdit","shopcartData","isFinished","allShopcartData","recommendData"])),methods:{loadData:function(){var t=this;setTimeout((function(){t.isLoading=!1,t.shopcartData.length>=t.allShopcartData.length&&t.$store.commit("shopcartModule/changeData",{key:"isFinished",value:!0}),t.$store.commit("shopcartModule/loadShopcartData",6)}),1e3)},allSelect:function(){this.sum(),this.$store.commit("shopcartModule/allSelect",this.isAllChecked)},simpleSelect:function(t){this.sum();for(var a=0;a<this.shopcartData.length;a++)if(!this.shopcartData[a].isChecked)return void(this.isAllChecked=!1);this.isAllChecked=!0},sum:function(){var t=this;this.total=0,this.shopcartData.forEach((function(a){a.isChecked&&(t.total+=a.price*a.count*100)}))},changeCount:function(t){var a=this,e=n["a"].getToken(this);this.axios({method:"POST",url:"/modifyShopcartCount",data:{appkey:this.appkey,tokenString:e,sid:t.sid,count:t.count},transformRequest:n["a"].transformRequest}).then((function(t){a.sum()})).catch((function(t){}))},manage:function(){this.$store.commit("shopcartModule/manage")},removeShopcart:function(t,a){var e=this;this.$toast.loading({forbidClick:!0,duration:0,message:"处理中..."});var s=[];if("all"==t?this.shopcartData.forEach((function(t){t.isChecked&&s.push(t.sid)})):(t="one")&&s.push(a.sid),0!=s.length){var i=JSON.stringify(s),o=n["a"].getToken(this);this.axios({method:"POST",url:"/deleteShopcart",data:{appkey:this.appkey,tokenString:o,sids:i},transformRequest:n["a"].transformRequest}).then((function(t){e.$toast.clear(),e.$toast.success({message:"成功删除商品"}),e.$store.commit("shopcartModule/removeShopcartData",s),e.sum(),0==e.shopcartData.length&&(e.isAllChecked=!1)})).catch((function(t){e.$toast.clear()}))}else this.$toast({message:"没有选择商品"})},commit:function(){var t=[];this.shopcartData.forEach((function(a){a.isChecked&&t.push(a.sid)})),0!=t.length?this.$router.push({name:"Pay",query:{sids:t.join("-")}}):this.$toast.fail({message:"请选择商品"})},getRecommendData:function(){var t=this;this.axios({method:"GET",url:"/typeProducts",params:{appkey:this.appkey,key:"isHot",value:1}}).then((function(a){var e=a.data.result.splice(0,4);500==a.data.code&&t.$store.commit("shopcartModule/changeData",{key:"recommendData",value:e})})).catch((function(t){}))},goPage:function(t){this.$router.push({name:"Detail",params:{pid:t}})}}},l=r,h=(e("79db"),e("2877")),d=Object(h["a"])(l,s,i,!1,null,"54b9ccef",null);a["default"]=d.exports}}]);
//# sourceMappingURL=chunk-c92a5822.5b0c228c.js.map